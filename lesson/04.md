# 4. Компилировать только изменения.

### lesson04.1

В файле [src/control.hpp](/../lesson04.1/src/control.hpp), [посмотреть отличия](/../../compare/c041..c041a), добавляем флаг `Control::error` в качестве признака того, что вызывался компилятор хотя бы для одного файла, следовательно требуется пересборка исполняемого файла. Также добавляем source_mtime и dependencies в заголовок функции `Control::start`.

В файле [src/compiler.hpp](/../lesson04.1/src/compiler.hpp), [посмотреть отличия](/../../compare/c041a..c041b), добавляем заголовок функции `Compiler::check_dependencies`. Эта функция проверяет список подключаемых файлов и возвращает true при необходимости вызова компилятора. Также добавляем source_mtime и dependencies в заголовок конструктора `Compiler` и в качестве полей этого класса.

В файле [src/control.cpp](/../lesson04.1/src/control.cpp), [посмотреть отличия](/../../compare/c041b..c041c), добавляем source_mtime и dependencies в функцию `Control::start`.

В файле [src/compiler.сpp](/../lesson04.1/src/compiler.сpp), [посмотреть отличия](/../../compare/c041c..c041d), добавляем source_mtime и dependencies в конструктор `Compiler`.

В файле [src/main.сpp](/../lesson04.1/src/main.сpp), [посмотреть отличия](/../../compare/c041d..c041e), добавляем проверки времени изменений файлов и вызов компилятора в режиме формирования файла зависимостей.

На этом шаге результат сборки будет нефункциональным.

### lesson04.2

### lesson04.3

Добавим выбор между `-I` и `-isystem`. Это позволит уменьшить количество элементов в файле с зависимостями.
